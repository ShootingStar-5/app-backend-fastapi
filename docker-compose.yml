# docker-compose.yml
# Docker 컨테이너 관리 설정 파일
# FastAPI 서버를 실행합니다 (데이터베이스 미사용)

version: '3.8'

services:
  # ============================================
  # 웹 서버 서비스 (FastAPI)
  # ============================================
  web:
    # 현재 디렉토리의 Dockerfile을 사용하여 이미지를 빌드
    build:
      context: .
      dockerfile: Dockerfile

    # 컨테이너 이름 설정
    container_name: app-fastapi-server

    # 포트 매핑: 로컬의 8000 포트를 컨테이너의 8000 포트에 연결
    # 브라우저에서 http://localhost:8000 으로 접속 가능
    ports:
      - "8000:8000"

    # 볼륨 설정: 로컬 코드를 컨테이너에 마운트
    # 코드를 수정하면 즉시 컨테이너에 반영됩니다 (--reload 옵션과 함께 사용)
    volumes:
      - ./app:/app

    # 환경 변수 파일 지정
    # .env 파일의 내용을 환경 변수로 사용합니다
    env_file:
      - .env

    # 컨테이너가 중지되면 자동으로 재시작
    # 개발 중 에러로 서버가 중단되어도 자동으로 다시 시작됩니다
    restart: unless-stopped
